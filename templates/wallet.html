<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Reload Wallet</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="sidebar" id="sidebar">
        <div id="sidebar-toggle">
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div>
        </div>
        <div class="sidebar-content">
            <a href="{{ url_for('dashboard') }}"><span>Dashboard</span></a>
            <a href="{{ url_for('account') }}"><span>Account</span></a>
            <a href="{{ url_for('vehicle_list') }}"><span>Vehicle</span></a>
            <a href="{{ url_for('wallet') }}"><span>Reload</span></a>
            <a href="{{ url_for('history') }}"><span>History</span></a>
            <a href="{{ url_for('logout') }}"><span>Logout</span></a>
        </div>
    </div>

    <div class="main-content">
        <div class="container-centered">
            <h2>Reload Wallet</h2>
            <p>Current Balance: <span id="wallet-balance">RM{{ balance }}</span></p>

            <form id="wallet-form" method="post">
                <label for="amount">Enter amount to reload:</label>
                <input type="number" id="amount" name="amount" min="1" class="form-input" required>

                <h2>Quick Reload</h2>
                <div class="quick-btn-group">
                    <button type="button" class="quick-btn vehicle-action-btn" data-amount="10">RM10</button>
                    <button type="button" class="quick-btn vehicle-action-btn" data-amount="20">RM20</button>
                    <button type="button" class="quick-btn vehicle-action-btn" data-amount="50">RM50</button>
                    <button type="button" class="quick-btn vehicle-action-btn" data-amount="100">RM100</button>
                </div>

                <button type="button" id="reload-scan-btn">Reload</button>

                <!-- Face scan block below button -->
                <div id="face-scan-block" style="display:none; margin-top: 20px;">
                    <h3>Face Authentication</h3>
                    <video id="video" width="300" autoplay></video>
                    <canvas id="canvas" style="display:none;"></canvas>
                    <p id="status-text">Initializing camera...</p>
                </div>

                <a href="{{ url_for('dashboard') }}" class="back-to-dashboard-link">‚Üê Back to Dashboard</a>

                {% if message %}
                    <p id="reload-success-message" class="success-message special-success">{{ message }}</p>
                {% endif %}
            </form>
        </div>
    </div>

    <script>
        // Safely assign with fallback to 0
        window.initialBalance = {{ balance | default(0, true) | tojson }};
    </script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
