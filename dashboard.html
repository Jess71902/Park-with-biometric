<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        window.initialBalance = Number("{{ balance }}");
        window.paymentSummary = {{ payment_summary | default('', true) | tojson }};
        window.parkingSeconds = Number("{{ parking_seconds | default(0) }}");
    </script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</head>
<body>

    <!--Side bar--> 
<div class="sidebar" id="sidebar">
    <div id="sidebar-toggle">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
    </div>
    <div class="sidebar-content">
        <a href="{{ url_for('dashboard') }}"><span>Dashboard</span></a>
        <a href="{{ url_for('account') }}"><span>Account</span></a>
        <a href="{{ url_for('vehicle_list') }}"><span>Vehicle</span></a>
        <a href="{{ url_for('wallet') }}"><span>Reload</span></a>
        <a href="{{ url_for('history') }}"><span>History</span></a>
        <a href="{{ url_for('logout') }}"><span>Logout</span></a>
    </div>
</div>

<div class="main-content">
    <div class="container-centered">
        <h2>Dashboard</h2>
        <form id="payment-form" method="post">
            <label for="location">Select location:</label>
            <select name="location" id="location" class="form-input" required> 
                <!--Location drop down list--> 
                <option value="" disabled selected>Choose location</option>
                <option value="Lot A">Lot A</option>
                <option value="Lot B">Lot B</option>
                <option value="Lot C">Lot C</option>
            </select>

            <label for="duration">Duration (hours):</label>
            <input type="number" id="duration" name="duration" min="1" class="form-input" required>

            <div class="vehicle-card">
                <div class="vehicle-number">
                    Current vehicle: {{ selected_vehicle if selected_vehicle else 'None selected' }}
                    <a href="{{ url_for('vehicle_list') }}" class="edit-btn">✏️ Edit</a>
                </div>
            </div>

            <h3>
                Wallet balance: <span id="wallet-balance" class="wallet-balance">RM{{ balance }}</span>
                <a href="{{ url_for('wallet') }}" class="reload-btn">Reload</a>
            </h3>

            <button type="button" class="login-btn" id="face-scan-btn">Make Payment</button>

            <div id="face-scan-block" style="display:none; margin-top: 20px;">
                <h3>Face Authentication</h3>
                <video id="video" width="300" autoplay></video>
                <canvas id="canvas" style="display:none;"></canvas>
                <p id="status-text">Initializing camera...</p>
            </div>

            <p id="payment-success-message" class="success-message" style="display: none;">Payment successful!</p>
            <p>Parking Time Left: <span id="parking-timer">00:00:00</span></p>
        </form>
    </div>
</div>

</body>
</html>
